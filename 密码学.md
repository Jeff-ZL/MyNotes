# 密码学

*Author: ZhaoLulu@BJTU*

*Teacher: LiLin@BJTU*

*Date: 2021.9.8*

## 第0章 课程介绍

### 0.1 教学目标

密码技术是信息安全与保密的关键技术之一，也是其他信息安全与保密技术的基础。

- 掌握密码学的基本概念、基本原理、基本思想与基本方法。
- 掌握国内外典型密码算法和密码学的应用技术。
- 具备典型密码的软件开发能力和密码应用能力。

### 0.2 课程内容

1. 密码学概述
2. 相关数学知识
3. 古典密码
4. 分组密码
5. 序列密码
6. 随机数产生
7. 公钥密码
8. 哈希函数
9. 消息认证
10. 数字签名
11. 密钥管理与分发
12. 用户认证

### 0.3 课程安排

- 上课时间：周二 8:00-9:50 SX402 周五 10:00-12:20 SX402
- 实验：7-8次
- 专题报告+展示：第15周 SX402
- 考试：期中+期末
- 作业

### 0.4 课程考核

总成绩 = 平时成绩（期中考试、作业、实验、报告/答辩、考勤）50% + 期末考试50%

### 0.5 实验课和作业要求

- 作业提交时间：每周讲课后的下周二上课时间
- 实验报告提交截止时间：实验周日晚24点（以邮件系统时间为准）
- 实验报告命名：学号_实验1.rar

## 第1章 密码学概述

### 1.1 信息安全事件与密码法

- 2018年8月28日，华住旗下酒店客户信息泄露。
- 2017年5月12日，Wannacry勒索软件蠕虫在互联网上大范围传播，我国大量行业企业内网大规模感染，包括企业、医疗、电力、能源、银行、交通等多个行业均遭受不同程度影响。
- 2021年6月30日，滴滴在美国纽交所上市。2021年7月2日，滴滴迎来国家网信办网络安全审查办公室的网络安全审查。2021年7月4日，滴滴出行因APP存在严重违法违规手机使用个人信息问题，被国家互联网信息办公室依据《中华人民共和国网络安全法》相关规定下架。
- 2019年10月26日，十三届全国人大常委会第十四次会议通过《中华人民共和国密码法》，定于2020年1月1日起施行。密码是国家重要战略资源，是保障网络语信息安全的核心技术和基础支撑。密码工作是党和国家的一项特殊重要工作，直接关系国家政治安全、经济安全、国防安全和信息安全。

### 1.2 什么是密码？

- 密码是一种用来混淆的技术，它希望将正常的、可识别的信息转变为无法识别的信息。
- 密码是指使用**特定变换**对数据等信息进行**加密保护**或者**安全认证**的物项和技术。（密码法中的表述）
  - 加密保护是指使用特定变换将原始信息变成攻击者不能识别的符号序列，从而保护信息的机密性。
  - 安全认证是指使用特定变换，确认信息是否被篡改、来自可靠信息源以及确认信息发送行为是否真实存在等，从而保护信息来源的真实性、数据的完整性和行为的不可否认性。
  - 物项是指实现加密保护或安全认证功能的设备与系统。
  - 技术是指利用物项实现加密保护或安全认证功能的方法或手段。

### 1.3 什么是密码学？

- 密码学是一个既古老又新兴的学科，它研究信息在系统中如何表示，如何针对这个表示计算其被破解代价的学问。

- 密码学被分类成密码编码学（Crypyography）和密码分析学（Cryptanalytics）。密码学在这两个相互对立、相互促进的问题中发展起来。

### 1.4 密码的主要功能

| 功能       | 内容                                                         |
| ---------- | ------------------------------------------------------------ |
| 机密性     | 保证信息不被泄露给非授权的个人、计算机等实体的性质。         |
| 完整性     | 数据没有收到非授权的篡改或破坏的性质。                       |
| 不可否认性 | 也称抗抵赖性，指一个已经发生的操作行为无法否认的性质。       |
| 真实性     | 信息来源的真实性是指保证信息来源可靠、没有被伪造和篡改的性质；身份真实性是指信息收发双方的身份与声称的相一致。 |

### 1.5 基本术语

- 消息被称为**明文 (Plaintext)**。
- 用某种方法伪装消息以隐藏它的内容的过程称为**加密 (Encryption)**。
- 消息被加密后得到的信息称之为**密文 (Ciphertex)**。
- 把密文转变为明文的过程称为**解密 (Decryption)**。
- 对明文进行加密操作的人员称为**加密员或密码员 (Cryptographer)**。
- 加密和解密算法的操作通常都是在一组密钥的控制下进行的，分别称为**加密密钥 (Encryption Key)**和**解密密钥 (Decryption Key)**。
- **密码算法 (Cryptography Algorithm)**是用于加密和解密的数学函数。
- 密码员对明文进行加密操作时所采用的一组规则称作**加密算法 (Decryption Algorithm)**。
- 所传送信息的预定对象称为**接收者 (Receiver)**。
- 接收者对密文解密所采用的的一组规则称为**解密算法 (Decryption Algorithm)**。
- **破译者 (Codebreakers)**。

### 1.6 加密通信的模型

<img src="figures/mm1-1.png" alt="mm1-1" style="zoom:50%;" />

密码学的目的是User A和User B两个人在不安全的信道上进行通信，而破译者不能理解他们通信的内容。

### 1.7 密码体制的定义

一个密码是满足以下条件的五元组$(P,C,K,E,D)$：

1. $P$表示所有可能的明文组成的有限集；
2. $C$表示所有可能的密文组成的有限集；
3. $K$代表密钥空间，有所有可能的密钥组成的有限集；
4. 对任意的$k \in K$，都存在一个加密法则$e_k \in E$和相应的解密法则$d_k \in D$。并且对每一个$e_k : P \to C, d_k: C \to P$，对任意的明文$x \in P$，均有$d_k(e_k(x)) = x$。

### 1.8 实用密码体制需要满足的基本条件

- 有效性：每个加密函数$e_k$和每个解密函数$d_k$应当能被有效地计算。
- 安全性：即使看到密文串$y$，窃听者$Oscar$确定所用的密钥$k$或明文串$x$是不可行的。

### 1.9 密码体制的分类

<img src="figures/mm1-2.png" alt="mm1-2" style="zoom:50%;" />

- 基于密钥的算法，按照密钥的特点可以分类：
  - **对称密码算法 (symmetric cipher)**：又称为传统密码算法 (conventional cipher)，就是加密密钥和解密密钥相同，或实质上相同，即从一个易于推出另一个，又称秘密密钥算法或单密钥算法。
    1. 优点：效率高、算法简单、适合加密大量数据
    2. 缺点：需要安全的密钥交换、用户多时密钥量大
  - **非对称密码算法 (asymmetric cipher)**：加密密钥和解密密钥不相同，从一个很难推出另一个，又称公开密钥算法 (public-key cipher)。
    1. 优点：不需要安全的密钥交换、解决了密钥管理的问题
    2. 缺点：效率较低、不适合加密大量数据、密钥产生较麻烦
  - 混合系统 = 非对称密码算法 + 对称密码算法
- 按照明文的处理方法可以分类：
  - **分组密码 (block cipher)**：将明文分成固定长度的组，用同一密钥和算法对每一块加密，输出也是固定长度的密文。
  - **流密码 (stream cipher)**：又称为序列密码。序列密码每次加密一位或一字节的明文，通常也被称为流密码。

### 1.10 密码学的起源和发展

- 古代加密算法（手工阶段）
- 古典密码学（机械阶段）
- 现代密码学（计算机阶段）

### 1.11 我国密码的发展历程

- 我国的密码体系起步晚于美国，但可借鉴先进经验。
- 我国密码算法研制跟国际密码算法研制水平相当，但密码产业特别是密码应用方面存在近20年差距。

<img src="figures/mm1-3.png" alt="mm1-3" style="zoom:50%;" />

### 1.12 密码分析 (Cryptanalysis)

- 目的在于复原密钥而非仅仅是明文。
- 常用手段包括：密码破译 (Cryptanalytic Attack)、暴力攻击 (Brute-force Attack)。
- 如果密码分析成功则所有密钥的使用都是危险的。

### 1.13 密码破译 (Cryptanalytic Attack)

- Kerckhoff原则：假设破译者Oscar是在已知密码体制的前提下来破译Bob使用的密钥。
- 常见的破解类型包括
  - 唯密文攻击：Oscar具有密文串$y$
  - 已知明文攻击：Oscar具有明文串$x$和相应的密文$y$。
  - 选择明文攻击：Oscar可获得对加密机的暂时访问，因此他能选择明文$x$并构造出相应的密文串$y$。
  - 选择密文攻击：Oscar可暂时接近密码机，可选择密文串$y$，并构造出相应的明文串$x$。
- 破译方法：归纳与演绎
- 破译步骤：分析、假设、推测、证实
- 破译三大要素
  - 语言的频率特征：e
  - 语言的连接特征：q, u, l, e, x
  - 语言的重复特征：th, tion, tious

### 1.14 暴力攻击 (Brute-force Attack)

<img src="figures/mm1-4.png" alt="mm1-4" style="zoom:50%;" />

### 1.15 密码算法的安全性

- 计算安全性 (Computationally Secure)

  - 攻破密体制所需要的付出的计算代价查过信息本身价值或付出的时间超出信息有效期。

  - 没有一个已知的实际密码体制能够在这个定义下被证明安全。

- 可证明安全 (Provable Security)

  - 可以证明一类命题：如果给定的整数$n$不可分解，那么给定的密码体制是不可破解的，这种类型的密码体制是可证明安全的。

- 无条件安全 (Unconditionally Secure)

  - 即使提供了无穷的计算资源也无法被破解的密码体制称为无条件安全。
  - 无论破译者有多少米文也无法解出明文或无法验证结果正确性。
  - 一次一密乱码本 (Onetime Pad)、量子密码。

### 1.16 密码学研究的基本问题

1. 密码体制相关概念
2. 单向函数和伪随机序列生成器
3. 数字签名和杂凑函数
4. 消息认证和身份识别
5. 各类密码协议（如密钥签发、秘密共享、零知识证明）

### 1.17 密码学的应用

1. 军事外交等机要通信
2. 电子政务、电子商务
3. 金融证券
4. 物联网、工业互联网、车辆网
5. 区块链技术
